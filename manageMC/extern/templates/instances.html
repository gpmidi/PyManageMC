{% extends "base.html" %}
{% load cache %}
{# Default page #}

{% block quick %}
    {% cache 60 instancesQuick0 %}
    
        {# Instance Group Listings #}
        <ul class="nav nohover">
		    <li>By Status Type</li>
	        {% for sgroup in serverStatusGroups %}
	            <li><a href="/e/instances/statusgroup/{{ sgroup }}/">{{ sgroup|capfirst }}</a></li>      
            {% endfor %}
		</ul>       
		
        {# By Status #}
        <ul class="nav nohover">
            <li>By Status</li>
			{% for status in serverStatuses %}
			    <li><a href="/e/instances/statusgroup/{{ status }}/">{{ status|capfirst }}</a></li>      
			{% endfor %}
        </ul>       
        
    {% endcache %}
{% endblock %}

{% block body %}
    {% cache 60 instancesBody0 user.is_staff %}
        <div class="newsbox">
            <h1>Minecraft Servers</h1>
            {% for instance in serverInstances %}
                <div class="newspost">
                    <div>
                        <h2 class="NewsTitle">
                            <a href="/e/instances/instance/{{ instance.name|urlencode }}/">
                                {{ instance.humanName }}
                            </a>
                        </h2>
                        <span>ID <a href="/e/instances/instance/{{ instance.name|urlencode }}/">{{ instance.name }}</a> ({{ instance.get_status_display }})</span>
                    </div>
                    <p class="News">                        
                        <b>Status: </b> {{ instance.status }}<br/>
                        
                        <b>Connection Info</b><br/>
                        <ul>
                            {% for info in instance.serverinstanceexternalinfo_set.all %}
                                <li>{{ info.host }}:{{ info.port }}</li>
                            {% endfor %}
                        </ul>
                        
                        <b>Owner: </b> {{ instance.owner}}<br/>
                        
                        <b>Admins: </b><br/>
                        <ul>
                            {% for admin in instance.admins.all %}
                                <li>{{ admin }}</li>
                            {% endfor %}
                        </ul>
                        
                        {% if user.is_staff %}
                            <b>Internal IP: </b> {{ instance.internalIP }}<br/>
                            <b>Internal Port: </b> {{ instance.port }}<br/>
                            <b>System: </b> {{ instance.system }}<br/>
                        {% endif %}
                    </p>
                </div>
            {% endfor %}
        </div>
    {% endcache %}
{% endblock %}
