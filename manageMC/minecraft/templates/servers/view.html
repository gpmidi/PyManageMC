{% extends "base.html" %}
{% load cache %}
{# view/edit a server #}

{% block title %}{{ server.name }} - Minecraft Server Manager{% endblock %}
{% block body %}	
	<div id="serverstatus">
	   <h4>Server Status</h4>
	   <script type="text/javascript">    
		   (function(){
			   Dajaxice.minecraft.server_status (
					    Dajax.process,
		                {'server_pk':{{ server.pk }}}
		                );
			    setTimeout(arguments.callee, 2500);
			})();
	    </script>
	       <div>
	           <input id="servermessage" type="text" name="serverstatus"
	           onclick="Dajaxice.minecraft.server_status (function(){},{'server_pk':{{ server.pk }}});"
	           />
	       </div>
	</div>
	
	<hr/>
	<h4>Server Info</h4>
	<form action="." method="post">
		{% csrf_token %}
		<table border="0">
			{{ form.as_table }}
		</table>
		<input type="submit" value="submit"/>
	</form>
	
	
	<hr/>
    <h4>Start</h4>
    <script type="text/javascript">    
    var srvstart = function() {
        Dajaxice.minecraft.server_start (
        		Dajax.process,
                {'server_pk':{{ server.pk }}}
                );
    };
    </script>
    <input type="submit" value="start" onclick="srvstart()"/>
    
    
    <hr/>
    <h4>Stop</h4>
    <script type="text/javascript">    
    var srvstop = function() {
        Dajaxice.minecraft.server_stop (
        		Dajax.process,
                {'server_pk':{{ server.pk }}}
                );
    };
    </script>
    <input type="submit" value="stop" onclick="srvstop()"/>
    
    
    <hr/>
    <h4>Say Something</h4>
    <script type="text/javascript">    
    var srvsay = function() {
    	Dajaxice.minecraft.server_say(
    			Dajax.process,
                {
                    'server_pk':{{ server.pk }},
                    'message':$("#tosay").val()
                    }
                );
    	$("#tosay").val("");
    };
    var forEnter = function(event) {
        if (event.which == 13 || event.keyCode == 13) {
        	event.preventDefault();
        	srvsay();
        };
    };
    </script>
    <input id="tosay" type="text" name="tosay" onkeypress="forEnter(event)"/>
    <input type="submit" value="say" onclick="srvsay()"/>
    
{% endblock %}
